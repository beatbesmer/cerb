{
    "name": "ai.cerb.automationBuilder.action.metricIncrement",
    "description": "Helper for the `metric.increment:` command in the automation editor",
    "extension_id": "cerb.trigger.interaction.worker",
    "script": "start:\r\n  await/metric:\r\n    form:\r\n      title: metric.increment:\r\n      elements:\r\n        sheet/prompt_metric:\r\n          label: Metric:\r\n          required@bool: yes\r\n          data:\r\n            automation:\r\n              uri: cerb:automation:cerb.data.records\r\n              inputs:\r\n                record_type: metric\r\n                query@text:\r\n          limit: 20\r\n          schema:\r\n            layout:\r\n              headings@bool: no\r\n              paging@bool: yes\r\n              filtering@bool: yes\r\n              title_column: _label\r\n              style: columns\r\n            columns:\r\n              selection/id:\r\n                params:\r\n                  mode: single\r\n                  label_key: _label\r\n              text/description:\r\n        submit:\r\n          continue@bool: no\r\n          reset@bool: no\r\n  \r\n  set:\r\n    metric__context: metric\r\n    metric_id@key: prompt_metric\r\n    snippet:\r\n      metric.increment:\r\n        inputs:\r\n          metric_name: {{metric_name}}\r\n        output: results\r\n        on_error:\r\n        on_success:\r\n  \r\n  outcome/hasDimensions:\r\n    if@bool: {{metric_dimensions}}\r\n    then:\r\n      repeat:\r\n        each@csv: {{metric_dimensions|keys|join(',')}}\r\n        as: dimension\r\n        do:\r\n          decision/type:\r\n            outcome/record:\r\n              if@bool: {{'record' == metric_dimensions[dimension].type}}\r\n              then:\r\n                var.set:\r\n                  inputs:\r\n                    key: snippet:metric.increment:inputs:dimensions:{{dimension}}@int\r\n                    value@raw: {{record_id}}\r\n            outcome/number:\r\n              if@bool: {{'number' == metric_dimensions[dimension].type}}\r\n              then:\r\n                var.set:\r\n                  inputs:\r\n                    key: snippet:metric.increment:inputs:dimensions:{{dimension}}@int\r\n                    value: 123\r\n            outcome/else:\r\n              then:\r\n                var.set:\r\n                  inputs:\r\n                    key: snippet:metric.increment:inputs:dimensions:{{dimension}}\r\n                    value: text\r\n  \r\n  return:\r\n    snippet: {{snippet|kata_encode}}",
    "policy_kata": "commands:\r\n  # [TODO] Specify a command policy here (use Ctrl+Space for autocompletion)\r\n  ",
    "created_at": 1640132119,
    "updated_at": 1640230862
}