{
    "name": "ai.cerb.eventHandler.automation",
    "description": "",
    "extension_id": "cerb.trigger.interaction.internal",
    "script": "inputs:\r\n  text/trigger:\r\n    required@bool: yes\r\n    type: freeform\r\n\r\nstart:\r\n  await:\r\n    form:\r\n      title: Chooser an automation\r\n      elements:\r\n        sheet/prompt_automation_id:\r\n          data:\r\n            automation:\r\n              uri: cerb:automation:cerb.data.records\r\n              inputs:\r\n                record_type: automation\r\n                query@text:\r\n                  trigger:${trigger}\r\n                query_params:\r\n                  trigger: {{inputs.trigger}}\r\n          limit: 20\r\n          required@bool: yes\r\n          schema:\r\n            layout:\r\n              paging@bool: yes\r\n              headings@bool: no\r\n              filtering@bool: yes\r\n              style: columns\r\n            columns:\r\n              selection/id:\r\n                params:\r\n                  mode: single\r\n                  label_key: _label\r\n              text/description:\r\n          toolbar:\r\n            interaction/add:\r\n              label: Create\r\n              icon: circle-plus\r\n              hidden@bool: {{not worker_is_superuser}}\r\n              uri: cerb:automation:ai.cerb.automation.create\r\n\r\n  set/load_automation:\r\n    automation_data__context: automation\r\n    automation_data_id@key: prompt_automation_id\r\n\r\n  return:\r\n    snippet@text:\r\n      {% apply spaceless %}\r\n      {% set automation_key = 'automation/' ~ random_string(6)|lower %}\r\n      {% set kata = \r\n        {\r\n          (automation_key): {\r\n            'uri': 'cerb:automation:' ~ automation_data_name,\r\n            '#disabled@bool': 'yes',\r\n          }\r\n        }\r\n      %}\r\n      {% set inputs = automation_data_inputs %}\r\n      {% if inputs is iterable and inputs is not empty %}\r\n        {% set kata = dict_set(kata, automation_key ~ '.inputs', []) %}\r\n        {% for input in inputs %}\r\n          {% if input.snippet is iterable -%}\r\n            {% set kata = dict_set(kata, automation_key ~ '.inputs.' ~ input.snippet|keys|first, input.snippet|first) %}\r\n          {% else %}\r\n            {% set kata = dict_set(kata, automation_key ~ '.inputs.' ~ input.key, '') %}\r\n          {% endif -%}\r\n        {% endfor %}\r\n      {% endif %}\r\n      {% endapply %}\r\n      {{kata|kata_encode}}",
    "policy_kata": "",
    "created_at": 1600722810,
    "updated_at": 1640218354
}